(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1361:(e,l,o)=>{"use strict";o.r(l),o.d(l,{default:()=>h});var r=o(5155),t=o(2115),a=o(3925);function s(e){let{onTableDataChange:l}=e,o=(0,t.useRef)(null),[s,d]=(0,t.useState)("");return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"数据输入"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,r.jsx)("input",{type:"file",ref:o,onChange:e=>{var o;let r=null==(o=e.target.files)?void 0:o[0];if(!r)return;let t=new FileReader;t.onload=e=>{var o;let r=null==(o=e.target)?void 0:o.result,t=a.LF(r,{type:"binary"}),s=t.SheetNames[0],d=t.Sheets[s],n=a.Wp.sheet_to_json(d,{header:1});n.length>0?l({headers:n[0],rows:n.slice(1)}):l(null)},t.readAsBinaryString(r)},accept:".xlsx,.xls",className:"hidden"}),(0,r.jsx)("button",{onClick:()=>{var e;return null==(e=o.current)?void 0:e.click()},className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors",children:"上传Excel文件"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"支持.xlsx和.xls格式"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"或粘贴Markdown表格"}),(0,r.jsx)("textarea",{value:s,onChange:e=>{let o=e.target.value;d(o);let r=o.trim().split("\n");if(r.length>=2){let e=r[0].split("|").filter(e=>e.trim()).map(e=>e.trim());l({headers:e,rows:r.slice(2).map(e=>e.split("|").filter(e=>e.trim()).map(e=>e.trim()))})}},className:"w-full h-32 p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"粘贴Markdown格式的表格内容..."})]})]})]})}var d=o(8064);let n={default:{name:"默认",borderColor:"#e5e7eb",rowBg:"#ffffff",textColor:"#111827",headerRowBg:"#f3f4f6",headerColumnBg:"#f3f4f6"},blue:{name:"蓝色",borderColor:"#93c5fd",rowBg:"#eff6ff",textColor:"#1e40af",headerRowBg:"#3b82f6",headerColumnBg:"#3b82f6"},turquoise:{name:"土耳其蓝",borderColor:"#67e8f9",rowBg:"#ecfeff",textColor:"#164e63",headerRowBg:"#06b6d4",headerColumnBg:"#06b6d4"},kleinBlue:{name:"克莱因蓝",borderColor:"#4B61D1",rowBg:"#002FA7",textColor:"#FFFFFF",headerRowBg:"#000080",headerColumnBg:"#000080"},green:{name:"绿色",borderColor:"#86efac",rowBg:"#f0fdf4",textColor:"#166534",headerRowBg:"#22c55e",headerColumnBg:"#22c55e"},red:{name:"红色",borderColor:"#fca5a5",rowBg:"#fef2f2",textColor:"#991b1b",headerRowBg:"#ef4444",headerColumnBg:"#ef4444"},pink:{name:"粉红",borderColor:"#f9a8d4",rowBg:"#fdf2f8",textColor:"#9d174d",headerRowBg:"#ec4899",headerColumnBg:"#ec4899"},yellow:{name:"黄色",borderColor:"#fde047",rowBg:"#fefce8",textColor:"#854d0e",headerRowBg:"#eab308",headerColumnBg:"#eab308"},dark:{name:"暗黑",borderColor:"#374151",rowBg:"#1f2937",textColor:"#f3f4f6",headerRowBg:"#111827",headerColumnBg:"#111827"}};function i(e){let{tableRef:l,theme:o,onThemeChange:a,width:s,onWidthChange:i,onHighlightHeaderRow:c,highlightHeaderRow:h,onHighlightHeaderColumn:u,highlightHeaderColumn:g}=e,[m,x]=(0,t.useState)(!1),b=async()=>{if(l.current&&!m){x(!0);try{console.log("开始导出图片流程"),console.log("表格容器元素:",l.current);let e=window.devicePixelRatio;console.log("设备像素比:",e);let r=l.current.querySelector("table");if(!r)return void console.error("未找到表格元素");console.log("找到表格元素:",r),console.log("表格内容:",r.innerHTML);let t=document.createElement("div");t.style.width="".concat(s,"px"),t.style.height="auto",t.style.position="fixed",t.style.left="-9999px",t.style.top="-9999px",t.style.backgroundColor="#ffffff",console.log("创建临时容器:",t),document.body.appendChild(t);let a=r.cloneNode(!0),i=window.getComputedStyle(r);for(let e=0;e<i.length;e++){let l=i[e];a.style.setProperty(l,i.getPropertyValue(l))}let c=n[o];a.querySelectorAll("tr").forEach(e=>{e.querySelectorAll("th, td").forEach((e,l)=>{e.style.borderColor=c.borderColor,e.style.color=c.textColor,"TH"===e.tagName&&h?e.style.backgroundColor=c.headerRowBg:0===l&&g?e.style.backgroundColor=c.headerColumnBg:e.style.backgroundColor=c.rowBg})}),a.style.width="".concat(s,"px"),a.style.borderCollapse="collapse",a.style.visibility="visible",a.style.opacity="1",a.style.position="static",a.style.display="table",a.style.overflow="visible",a.style.border="1px solid ".concat(c.borderColor),console.log("克隆后的表格元素:",a),console.log("克隆表格内容:",a.innerHTML),console.log("克隆表格样式:",a.style),t.appendChild(a),console.log("等待500ms让内容加载..."),await new Promise(e=>setTimeout(e,500)),console.log("开始使用html-to-image渲染");let u=await (0,d.$E)(a,{backgroundColor:"#ffffff",pixelRatio:e});console.log("html-to-image渲染完成"),document.body.removeChild(t);let m=document.createElement("a");m.download="table-export.png",m.href=u,m.click()}catch(e){console.error("导出图片失败:",e)}finally{x(!1)}}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"表格设置"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"表格主题"}),(0,r.jsx)("select",{value:o,onChange:e=>a(e.target.value),className:"w-full px-2 py-1 border rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Object.entries(n).map(e=>{let[l,o]=e;return(0,r.jsx)("option",{value:l,children:o.name},l)})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"宽度 (px)"}),(0,r.jsx)("input",{type:"number",value:s,onChange:e=>{i(Number(e.target.value))},className:"w-24 px-2 py-1 border rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"100"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"highlightHeaderRow",checked:h,onChange:e=>c(e.target.checked),className:"mr-2"}),(0,r.jsx)("label",{htmlFor:"highlightHeaderRow",children:"表头(行)"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"highlightHeaderColumn",checked:g,onChange:e=>u(e.target.checked),className:"mr-2"}),(0,r.jsx)("label",{htmlFor:"highlightHeaderColumn",children:"表头(列)"})]}),(0,r.jsx)("button",{onClick:b,disabled:m,className:"px-4 py-1 rounded text-white ".concat(m?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"," transition-colors"),children:m?"导出中...":"导出为图片"})]})]})]})}function c(e){var l,o,t;let{tableData:a,theme:s,width:d,highlightHeaderRow:i=!1,highlightHeaderColumn:c=!1}=e;return a?(0,r.jsx)("div",{className:"overflow-x-auto",style:{width:d?"".concat(d,"px"):"auto"},children:(0,r.jsxs)("table",{className:"min-w-full border-collapse",style:{visibility:"visible",opacity:1,position:"static",border:"1px solid ".concat(null==(l=n[s])?void 0:l.borderColor)},children:[(0,r.jsx)("thead",{children:(0,r.jsx)("tr",{style:{backgroundColor:i?null==(o=n[s])?void 0:o.headerRowBg:null==(t=n[s])?void 0:t.rowBg},children:a.headers.map((e,l)=>{var o,t;return(0,r.jsx)("th",{className:"border px-4 py-2",style:{borderColor:null==(o=n[s])?void 0:o.borderColor,color:null==(t=n[s])?void 0:t.textColor},children:e},l)})})}),(0,r.jsx)("tbody",{children:a.rows.map((e,l)=>{var o;return(0,r.jsx)("tr",{style:c&&0===l?{backgroundColor:null==(o=n[s])?void 0:o.headerColumnBg}:{},children:e.map((e,l)=>{var o,t,a,d;return(0,r.jsx)("td",{className:"px-4 py-2 border",style:{borderColor:null==(o=n[s])?void 0:o.borderColor,color:null==(t=n[s])?void 0:t.textColor,backgroundColor:c&&0===l?null==(a=n[s])?void 0:a.headerColumnBg:null==(d=n[s])?void 0:d.rowBg},children:e},l)})},l)})})]})}):null}function h(){let e=(0,t.useRef)(null),[l,o]=(0,t.useState)(null),[a,d]=(0,t.useState)("default"),[n,h]=(0,t.useState)(800),[u,g]=(0,t.useState)(!1),[m,x]=(0,t.useState)(!1);return(0,r.jsx)("main",{className:"min-h-screen bg-gray-100 py-8 px-4",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{className:"md:col-span-1 space-y-6 bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)(s,{onTableDataChange:o}),(0,r.jsx)("hr",{className:"my-6"}),(0,r.jsx)(i,{tableRef:e,theme:a,onThemeChange:d,width:n,onWidthChange:h,highlightHeaderRow:u,onHighlightHeaderRow:g,highlightHeaderColumn:m,onHighlightHeaderColumn:x})]}),(0,r.jsxs)("div",{className:"md:col-span-2 bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"预览"}),(0,r.jsx)("div",{ref:e,className:"overflow-auto border border-gray-200 rounded",children:(0,r.jsx)(c,{tableData:l,theme:a,width:n,highlightHeaderColumn:m,highlightHeaderRow:u})})]})]})})}},2383:()=>{},3686:()=>{},8306:(e,l,o)=>{Promise.resolve().then(o.bind(o,1361))}},e=>{var l=l=>e(e.s=l);e.O(0,[524,64,441,684,358],()=>l(8306)),_N_E=e.O()}]);